
<!doctype html>
<html lang="zh-CN">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>FAD-60 家庭功能评定 · 即时评分</title>
<style>
  :root{--radius:16px;--border:#e5e7eb;--text:#111827;--muted:#6b7280;--bg:#f9fafb}
  *{box-sizing:border-box}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;max-width:860px;margin:0 auto;padding:16px;background:var(--bg);color:var(--text);line-height:1.55}
  h1{font-size:22px;margin:8px 0 4px}
  .muted{color:var(--muted)}
  .card{background:#fff;border:1px solid var(--border);border-radius:16px;padding:14px;margin:12px 0;box-shadow:0 2px 8px rgba(0,0,0,.04)}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  select,input,button{font:inherit}
  button{padding:12px 16px;border-radius:12px;border:1px solid #111;background:#111;color:#fff;cursor:pointer}
  button.secondary{background:#fff;color:#111;border-color:#ddd}
  .q{margin:10px 0}
  .q h3{font-size:16px;margin:0 0 8px}
  .opt{display:flex;gap:8px;align-items:center;margin:6px 0}
  .bar{height:10px;border-radius:999px;background:#eef2ff;position:relative;overflow:hidden}
  .bar>i{display:block;height:100%;background:#111}
  .grid{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center}
  details summary{cursor: pointer}
  .footer{font-size:12px;color:var(--muted);text-align:center;margin-top:12px}
  .tag{display:inline-block;background:#eef2ff;border:1px solid #dbeafe;color:#1e3a8a;padding:2px 8px;border-radius:999px;font-size:12px}
  .pill{display:inline-block;border:1px solid #e5e7eb;border-radius:999px;padding:6px 10px}
  .k{font-weight:600}
  @media (prefers-color-scheme: dark){
    :root{--border:#374151;--text:#f3f4f6;--muted:#9ca3af;--bg:#0b0f14}
    .card{background:#0f141b}
    .bar{background:#0b1020}
    .bar>i{background:#e5e7eb}
    button.secondary{color:#e5e7eb;border-color:#374151}
  }
</style>
<body>
  <header class="card">
    <div class="row" style="justify-content:space-between">
      <div>
        <h1>家庭功能量表 · 即时评分</h1>
        <div class="muted">单机本地计算，不上传；提交后立即得到个人分数与解释。</div>
      </div>
      <div><span class="tag">v1.0</span></div>
    </div>
    <div class="row" style="margin-top:8px">
      <span class="pill">量表：FAD-60（正式量表，四点计分）</span>
      <button class="secondary" id="btnReset">清空作答</button>
    </div>
  </header>

  <form id="form" class="card" novalidate>
    <div id="intro" class="muted" style="margin-bottom:8px">
      评分：很像我家=1，像我家=2，不像我家=3，完全不像我家=4（分数越低=功能越健康）。带“*”的题目为反向计分，系统自动处理。
    </div>
    <div id="items"></div>
    <div class="row" style="margin-top:8px">
      <button type="button" id="btnSubmit">提交并查看结果</button>
      <button type="button" class="secondary" id="btnCopy">复制结果文本</button>
    </div>
  </form>

  <section id="out" class="card" style="display:none">
    <h2 style="margin:0 0 6px">我的测评结果</h2>
    <div class="grid">
      <div class="muted">GF（总的功能）均值</div>
      <div id="totalScore" class="k" style="text-align:right"></div>
      <div class="muted">结论</div>
      <div id="totalLabel" style="text-align:right"></div>
    </div>
    <div id="advice" class="card" style="margin-top:10px"></div>

    <div id="domainsWrap" style="display:none;margin-top:8px">
      <h3 style="margin:0 0 6px">分维度</h3>
      <div id="domains"></div>
    </div>

    <details style="margin-top:10px">
      <summary>查看我的作答</summary>
      <pre id="answers" style="white-space:pre-wrap"></pre>
    </details>
  </section>

  <div class="footer">© 本页仅用于课堂演示；结果仅供教育参考，不构成诊断。</div>

<script>
const FAD60 = {
  options: [
    {label:'很像我家', score:1},
    {label:'像我家', score:2},
    {label:'不像我家', score:3},
    {label:'完全不像我家', score:4},
  ],
  items: [{"序号": 1, "text": "由于我们彼此误解，难于安排一些家庭活动。", "reverse": true, "domain": "总的功能"}, {"序号": 2, "text": "我们在住处附近解决大多数日常问题。", "reverse": false, "domain": "问题解决"}, {"序号": 3, "text": "当家中有人烦恼时，其他人知道他为什么烦恼。", "reverse": false, "domain": "沟通"}, {"序号": 4, "text": "当你要求某人去做某事时，你必须检查他们是否做了。", "reverse": true, "domain": "家庭角色分工"}, {"序号": 5, "text": "如果某人遇到麻烦时，其他人会过份关注。", "reverse": true, "domain": "情感参与"}, {"序号": 6, "text": "发生危机时，我们能相互支持。", "reverse": false, "domain": "总的功能"}, {"序号": 7, "text": "当发生了出乎预料的意外时，我们手足无措。", "reverse": true, "domain": "行为控制"}, {"序号": 8, "text": "我们家时常把我们所需要的东西用光了。", "reverse": true, "domain": "家庭角色分工"}, {"序号": 9, "text": "我们相互都不愿流露出自己的感情。", "reverse": true, "domain": "情感反应"}, {"序号": 10, "text": "我们肯定家庭成员都尽到了各自的家庭职责。", "reverse": false, "domain": "家庭角色分工"}, {"序号": 11, "text": "我们不能相互谈论我们的忧愁。", "reverse": true, "domain": "总的功能"}, {"序号": 12, "text": "我们常根据我们对问题的决定去行动。", "reverse": false, "domain": "问题解决"}, {"序号": 13, "text": "你的事只有对别人也重要时，他们才会感兴趣。", "reverse": false, "domain": "情感参与"}, {"序号": 14, "text": "从那些人正在谈的话中，你不明白其中一个人是怎么了。", "reverse": true, "domain": "沟通"}, {"序号": 15, "text": "家务事没有由家庭成员充分分担。", "reverse": true, "domain": "家庭角色分工"}, {"序号": 16, "text": "每个人是什么样的，都能被别人认可。", "reverse": false, "domain": "总的功能"}, {"序号": 17, "text": "你不按规矩办事，却很易逃脱处分。", "reverse": true, "domain": "行为控制"}, {"序号": 18, "text": "大家都把事情摆在桌面上说，而不用暗示的方法。", "reverse": false, "domain": "沟通"}, {"序号": 19, "text": "我们中有些人缺乏感情。", "reverse": true, "domain": "情感反应"}, {"序号": 20, "text": "在遇到突然事件时，我们知道怎么处理。", "reverse": false, "domain": "行为控制"}, {"序号": 21, "text": "我们避免谈及我们害怕和关注的事", "reverse": true, "domain": "总的功能"}, {"序号": 22, "text": "我们难得相互说出温存的感受。", "reverse": true, "domain": "沟通"}, {"序号": 23, "text": "我们遇到经济困难", "reverse": true, "domain": "家庭角色分工"}, {"序号": 24, "text": "在我们家试图解决一个问题之后，我们通常要讨论这个问题是否已解决", "reverse": false, "domain": "问题解决"}, {"序号": 25, "text": "我们太以自我为中心了", "reverse": true, "domain": "情感参与"}, {"序号": 26, "text": "我们能相互表达出自己的感受。", "reverse": false, "domain": "总的功能"}, {"序号": 27, "text": "我们对梳妆服饰习惯无明确要求。", "reverse": true, "domain": "行为控制"}, {"序号": 28, "text": "我们彼此间不表示爱意", "reverse": true, "domain": "情感反应"}, {"序号": 29, "text": "我们对人说话都直说，而不转弯抹角", "reverse": false, "domain": "沟通"}, {"序号": 30, "text": "我们每个人都有特定的任务和职责", "reverse": false, "domain": "家庭角色分工"}, {"序号": 31, "text": "家庭的情绪气氛很不好。", "reverse": true, "domain": "总的功能"}, {"序号": 32, "text": "我们有惩罚人的原则。", "reverse": false, "domain": "行为控制"}, {"序号": 33, "text": "只有当某事使我们都感兴趣时，我们才一起参加。", "reverse": true, "domain": "情感参与"}, {"序号": 34, "text": "没有时间去做自己感兴趣的事。", "reverse": true, "domain": "家庭角色分工"}, {"序号": 35, "text": "我们常不把自己的想法说出来。", "reverse": true, "domain": "沟通"}, {"序号": 36, "text": "我们感到我们能被别人容忍。", "reverse": false, "domain": "总的功能"}, {"序号": 37, "text": "我们在住处附近解决大多数日常问题。", "reverse": false, "domain": "情感参与"}, {"序号": 38, "text": "在我们家，亲密和温存居次要地位。", "reverse": true, "domain": "问题解决"}, {"序号": 39, "text": "我们能解决大多数情绪上的烦恼。", "reverse": false, "domain": "情感反应"}, {"序号": 40, "text": "我们讨论谁做家务。", "reverse": false, "domain": "家庭角色分工"}, {"序号": 41, "text": "在我们家对事情作出决定是困难的。", "reverse": true, "domain": "总的功能"}, {"序号": 42, "text": "我们家的人只有在对自己有利时，才彼此关照。", "reverse": true, "domain": "情感参与"}, {"序号": 43, "text": "我们相互间都很坦率。", "reverse": false, "domain": "沟通"}, {"序号": 44, "text": "我们不遵从任何规则和标准。", "reverse": true, "domain": "行为控制"}, {"序号": 45, "text": "如果要人去做某件事，他们常需别人提醒。", "reverse": true, "domain": "家庭角色分工"}, {"序号": 46, "text": "我们能够对如何解决问题作出决定。", "reverse": false, "domain": "总的功能"}, {"序号": 47, "text": "如果原则被打破，我们不知道将会发生什么事．", "reverse": true, "domain": "行为控制"}, {"序号": 48, "text": "在我们家任何事都行得通。", "reverse": true, "domain": "行为控制"}, {"序号": 49, "text": "我们将温存表达出来", "reverse": false, "domain": "情感反应"}, {"序号": 50, "text": "我们镇静地面对涉及感情的问题。", "reverse": false, "domain": "问题解决"}, {"序号": 51, "text": "我们不能和睦相处。", "reverse": true, "domain": "总的功能"}, {"序号": 52, "text": "我们一生了气，就互不讲话。", "reverse": true, "domain": "沟通"}, {"序号": 53, "text": "一般来说，我们对分配给自己的家务活都感到不满意。", "reverse": true, "domain": "家庭角色分工"}, {"序号": 54, "text": "尽管我们用意良好，但还是过多地干预了彼此的生活。", "reverse": true, "domain": "情感参与"}, {"序号": 55, "text": "我们有应付危险情况的原则。", "reverse": false, "domain": "行为控制"}, {"序号": 56, "text": "我们相互信赖。", "reverse": false, "domain": "总的功能"}, {"序号": 57, "text": "我们当众哭出声来。", "reverse": false, "domain": "情感反应"}, {"序号": 58, "text": "我们没有合适的交通工具。", "reverse": true, "domain": "家庭角色分工"}, {"序号": 59, "text": "当我们不喜欢有的人的所作所为时，我们就会给他指出来。", "reverse": false, "domain": "沟通"}, {"序号": 60, "text": "我们想尽各种办法来解决问题。", "reverse": false, "domain": "问题解决"}],
  cutoffs: { PS:2.20, CM:2.20, RL:2.30, AR:2.20, AI:2.10, BC:1.90, GF:2.00 },
  domainDesc: {"问题解决": "在面对困难或日常挑战时，家庭成员识别问题、协商并执行解决方案的能力。", "沟通": "家庭成员之间信息与情绪的表达、倾听与澄清的质量与效率。", "家庭角色分工": "家庭内职责、规则与期望是否清晰且能够被一致地遵循。", "情感反应": "家庭成员对情绪线索的觉察、表达与调节是否恰当与敏感。", "情感参与": "对彼此活动与内在体验的关注程度，以及相互投入与支持的质量。", "行为控制": "家庭在常规与非常规情境下的行为准则、边界与一致性。", "总的功能": "对整个家庭系统功能状况的综合评估。"},
};

const els = {
  btnReset: document.getElementById('btnReset'),
  form: document.getElementById('form'),
  items: document.getElementById('items'),
  out: document.getElementById('out'),
  totalScore: document.getElementById('totalScore'),
  totalLabel: document.getElementById('totalLabel'),
  advice: document.getElementById('advice'),
  domainsWrap: document.getElementById('domainsWrap'),
  domains: document.getElementById('domains'),
  answers: document.getElementById('answers'),
  btnSubmit: document.getElementById('btnSubmit'),
  btnCopy: document.getElementById('btnCopy'),
};

function render(){
  els.items.innerHTML = '';
  FAD60.items.forEach((q, idx)=>{
    const wrap = document.createElement('div'); wrap.className = 'q card';
    const star = q.reverse ? ' *' : '';
    const h = document.createElement('h3'); h.textContent = `Q${idx+1}. ${q.text}`; wrap.appendChild(h);
    const small = document.createElement('div'); small.className='muted'; small.textContent = `维度：${q.domain}${star}`; wrap.appendChild(small);
    FAD60.options.forEach((opt,j)=>{
      const id = `q${idx}_${j}`;
      const label = document.createElement('label'); label.className = 'opt'; label.htmlFor = id;
      label.innerHTML = `<input required type="radio" name="q_${idx}" id="${id}" value="${opt.score}"> <span>${opt.label}</span>`;
      wrap.appendChild(label);
    });
    els.items.appendChild(wrap);
  });
  els.out.style.display = 'none';
}

function calc(){
  let total = 0; const answers = []; const domains = new Map();
  const counts = {};
  FAD60.items.forEach(it => counts[it.domain] = (counts[it.domain]||0) + 1);
  for(let i=0;i<FAD60.items.length;i++){ 
    const sel = document.querySelector(`input[name="q_${i}"]:checked`);
    if(!sel){ alert(`第 ${i+1} 题未作答`); return null; }
    let s = parseFloat(sel.value);
    if(FAD60.items[i].reverse){ 
      const min = 1, max = 4; 
      s = max - (s - min); // 反向题换向到同向
    }
    total += s;
    answers.push({idx:i+1, score:s});
    const d = FAD60.items[i].domain; domains.set(d, (domains.get(d)||0)+s);
  }
  return {total, answers, domains, counts};
}

function percent(v, max){ return Math.max(0, Math.min(100, Math.round(v/max*100))); }

function showResult(data){
  // GF 平均值
  const gfSum = data.domains.get('总的功能')||0; 
  const gfN = data.counts['总的功能']||1;
  const gfMean = gfSum / gfN;
  const gfCut = FAD60.cutoffs.GF;
  const gfLabel = gfMean > gfCut ? '提示：总体功能可能存在一定挑战' : '提示：总体功能处于良好水平';
  els.totalScore.textContent = gfMean.toFixed(2) + '（均值，1–4）';
  els.totalLabel.textContent = `GF：${gfLabel}（阈值 > ${gfCut.toFixed(2)}）`;
  els.advice.textContent = gfMean > gfCut
    ? '结果提示：建议在沟通与问题解决等方面给予更多关注；如有需要，可联系学校辅导或专业人士进一步评估与支持。'
    : '结果提示：建议继续保持积极、稳定的互动模式，并关注日常沟通的连续性与质量。';

  // 分维度
  els.domainsWrap.style.display = '';
  els.domains.innerHTML = '';
  const code = { '问题解决':'PS', '沟通':'CM', '家庭角色分工':'RL', '情感反应':'AR', '情感参与':'AI', '行为控制':'BC', '总的功能':'GF' };
  for (const [name, sum] of data.domains.entries()){
    const n = data.counts[name]||1; const mean = sum / n;
    const cut = FAD60.cutoffs[code[name]] || 0;
    const label = mean > cut ? '提示：该维度可能存在一定功能挑战' : '提示：该维度功能处于良好水平';
    const row = document.createElement('div'); row.className='card';
    const ddesc = FAD60.domainDesc[name] || '';
    row.innerHTML = `
      <div class="grid">
        <div class="k">${name}（${code[name]||''}）</div>
        <div style="text-align:right">均值 ${mean.toFixed(2)} / 4</div>
      </div>
      <div class="bar" style="margin:6px 0 2px"><i style="width:${percent(sum, 4*n)}%"></i></div>
      <div class="muted" style="margin-top:4px">${ddesc}</div>
      <div class="muted" style="text-align:right;margin-top:4px">${label}（阈值 > ${cut.toFixed(2)}）</div>
    `;
    els.domains.appendChild(row);
  }

  // 作答文本
  els.answers.textContent = data.answers.map(a=>`Q${a.idx}: ${a.score}分`).join('\n');
  els.out.style.display = '';
}

function copyResult(){
  const txt = `【FAD-60 结果】\nGF均值：${els.totalScore.textContent}；${els.totalLabel.textContent}\n${els.advice.textContent}`;
  navigator.clipboard.writeText(txt).then(()=>alert('结果已复制'), ()=>alert('复制失败，可手动选择文本'));
}

els.btnReset.addEventListener('click', ()=>{ els.form.reset(); els.out.style.display='none'; });
els.btnSubmit.addEventListener('click', ()=>{ const data = calc(); if(!data) return; showResult(data); });
els.btnCopy.addEventListener('click', copyResult);

// 初始渲染
render();
</script>
</body>
</html>
